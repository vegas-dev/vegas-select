// @vegas-VGSelect v1.0.3
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).window=e.window||{})}(this,(function(e){"use strict";const t={hide:function(e){e.style.display="none"},show:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";e.style.display=t},listener:function(e,t,s){document.addEventListener(e,(function(e){let n=document.body.querySelectorAll(t),o=e.target,l=-1;for(;o&&-1===(l=Array.prototype.indexOf.call(n,o));)o=o.parentElement;l>-1&&function(){"function"==typeof s&&s(o,e),e.preventDefault()}.call(o,e)}))},merge:function(){const e=this,t=e=>e&&"object"==typeof e;for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return n.reduce(((s,n)=>(Object.keys(n).forEach((o=>{const l=s[o],r=n[o];Array.isArray(l)&&Array.isArray(r)?s[o]=l.concat(...r):t(l)&&t(r)?s[o]=e.merge(l,r):s[o]=r})),s)),{})},ajax:{x:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;let e,t=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];for(let s=0;s<t.length;s++)try{e=new ActiveXObject(t[s]);break}catch(e){}return e},send:function(e,s,n,o,l){void 0===l&&(l=!0);let r=t.ajax.x();r.open(n,e,l),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status)s("success",r.responseText);else s("error",r.responseText)},r.send(o)},get:function(e,s,n,o){let l=[];for(let e of s)l.push(encodeURIComponent(e[0])+"="+encodeURIComponent(e[1]));t.ajax.send(e+(l.length?"?"+l.join("&"):""),n,"GET",null,o)},post:function(e,s,n,o){t.ajax.send(e,n,"POST",s,o)}},getDataAttributes:function(e){let t={};return[].forEach.call(e.attributes,(function(e){if(/^data-/.test(e.name)){let s=e.name.substr(5).replace(/-(.)/g,(function(e,t){return t.toUpperCase()}));t[s]=e.value}})),t},isEmptyObj:function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}};e.VGSelect=class{constructor(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.classes={container:"vg-select",dropdown:"vg-select-dropdown",list:"vg-select-list",option:"vg-select-list--option",optgroup:"vg-select-list--optgroup",current:"vg-select-current",search:"vg-select-search"};const n={search:!1};return e?"SELECT"!==e.tagName?(console.error('Тэг должен быть "select"'),!1):(this.settings=function(e,s,n){let o=t.merge(s,n),l=[].filter.call(e.attributes,(function(e){return/^data-/.test(e.name)}));for(let e of l)"data-search"===e.name&&(o.search="false"!==e.value);return o}(e,n,s),void this.create(e)):(console.error("Первый параметр не должен быть пустым"),!1)}create(e){let s=e.options[e.selectedIndex].innerText,n=e.options,o=e.getAttribute("class"),l=document.createElement("div");o=o.split(" ");for(const e of o)l.classList.add(e);let r=t.getDataAttributes(e);if(!t.isEmptyObj(r))for(const e of Object.keys(r))l.setAttribute("data-"+e,r[e]);let c=document.createElement("div");c.classList.add(this.classes.current),c.innerText=s.trim(),l.append(c);let i=document.createElement("div");i.classList.add(this.classes.dropdown),l.append(i);let a=document.createElement("ul");a.classList.add(this.classes.list);let d=0;for(const s of n){let n=document.createElement("li");n.innerText=s.innerText.trim(),n.classList.add(this.classes.option),n.dataset.value=s.getAttribute("value");let o=t.getDataAttributes(s);if(!t.isEmptyObj(o))for(const e of Object.keys(o))n.setAttribute("data-"+e,o[e]);d===e.selectedIndex&&n.classList.add("selected"),s.hasAttribute("disabled")&&n.classList.add("disabled"),a.append(n),d++}i.append(a),e.insertAdjacentElement("afterend",l),this.settings.search&&this.search(l),this.toggle(l)}toggle(e){const s=this;e.querySelector("."+s.classes.current).onclick=function(e){let t=e.target.closest(".vg-select"),n=document.querySelectorAll(".vg-select");if(n.length)for(const e of n)e!==t&&e.classList.remove("show");if(t.classList.contains("show"))t.classList.remove("show");else if(t.classList.add("show"),s.settings.search){let e=t.querySelector("input");e&&e.focus()}return!1},t.listener("click","."+s.classes.option,(function(e,t){if(t.preventDefault(),!e.classList.contains("disabled")){let t=e.closest("."+s.classes.container),n=t.querySelectorAll("."+s.classes.option);if(n.length)for(const e of n)e.classList.remove("selected");e.classList.add("selected"),t.querySelector("."+s.classes.current).innerText=e.innerText,t.classList.remove("show");let o=t.previousSibling;o.value=e.dataset.value,o.dispatchEvent(new Event("change"))}})),window.addEventListener("click",(function(e){if(!e.target.closest(".vg-select")){let e=document.querySelectorAll(".vg-select");if(e.length)for(const t of e)t.classList.remove("show")}}))}search(e){const s=this;let n=e.querySelector("."+s.classes.dropdown),o=document.createElement("div");o.classList.add(s.classes.search);let l=document.createElement("input");l.setAttribute("name","vg-select-search"),l.setAttribute("type","text"),l.setAttribute("placeholder","Поиск..."),o.append(l),n.prepend(o),t.listener("keyup","[name=vg-select-search]",(function(e,n){n.preventDefault();let o=e.closest("."+s.classes.dropdown).querySelector("."+s.classes.list);if(o){let n=o.querySelectorAll("."+s.classes.option),l=e.value;for(const e of n)t.show(e);if(l.length){l=l.trim(),l=l.toLowerCase(),l=r(l,!0);for(const e of n){-1===e.innerText.toLowerCase().indexOf(l)&&t.hide(e)}}}}));const r=function(e,t){let s,n="й ц у к е н г ш щ з х ъ ф ы в а п р о л д ж э я ч с м и т ь б ю".split(/ +/g),o="q w e r t y u i o p [ ] a s d f g h j k l ; ' z x c v b n m , .".split(/ +/g);for(s=0;s<n.length;s++)e=(e=e.split(t?o[s]:n[s]).join(t?n[s]:o[s])).split(t?o[s].toUpperCase():n[s].toUpperCase()).join(t?n[s].toUpperCase():o[s].toUpperCase());return e}}}}));
